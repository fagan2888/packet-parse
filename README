<author info>

Name: Samuel Zhang
Penn ID: 37688955
Email: faz@seas.upenn.edu

</author info>


<example usage instructions>

Install:
make install

Compile, build:
clear; make clean; make all

Run:
./packetparse ./smtp.pcap                             # Part 1
./packetparse ./sampleimf.pcap                        # Part 1
./packetparse -t ./smtp.pcap      && bash least.sh    # Part 2
./packetparse -t ./sampleimf.pcap && bash least.sh    # Part 2
./packetparse -m ./smtp.pcap      && bash smtp.sh     # Part 3
./packetparse -m ./sampleimf.pcap && bash smtp.sh     # Part 3
./packetparse -c ./cookie.pcap    && bash cookies.sh  # Extra credit

Verbose error-logging (very slow):
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v    ./smtp.pcap      && bash least.sh    # Part 1
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v    ./sampleimf.pcap && bash least.sh    # Part 1
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v -t ./smtp.pcap      && bash least.sh    # Part 2
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v -t ./sampleimf.pcap && bash least.sh    # Part 2
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v -m ./smtp.pcap      && bash smtp.sh     # Part 3
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v -m ./sampleimf.pcap && bash smtp.sh     # Part 3
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all ./packetparse -v -c ./cookie.pcap    && bash cookies.sh  # Extra credit

Check intermediate debug output (after running Part 3):
bash debug.sh

</example usage instructions>


<external references>

Source library, manpages, standards documents:
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/in.h.html
http://man7.org/linux/man-pages/man3/ether_aton.3.html
https://linux.die.net/man/3/ntohs
https://linux.die.net/man/3/ether_ntoa
https://linux.die.net/man/3/inet_ntoa
https://linux.die.net/include/netinet/ether.h
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/if_ether.h.html
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/ip.h.html
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/udp.h.html
http://unix.superglobalmegacorp.com/BSD4.4Lite2/newsrc/netinet/tcp.h.html
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/
http://www.tcpdump.org/manpages/pcap-filter.7.html
https://www.winpcap.org/docs/docs_412/html/structpcap__pkthdr.html
http://www.tcpdump.org/manpages/pcap.3pcap.html
http://beej.us/guide/bgnet/output/html/multipage/htonsman.html
http://www.cplusplus.com/reference/unordered_map/unordered_map/
http://www.cplusplus.com/reference/string/to_string/
http://www.cplusplus.com/doc/tutorial/files/
http://www.cplusplus.com/reference/unordered_set/unordered_set/
http://www.cplusplus.com/reference/cstring/strcmp/
https://tools.ietf.org/html/rfc821
https://www.ietf.org/rfc/rfc822.txt
http://www.cplusplus.com/reference/string/string/reserve/
http://www.asciitable.com
https://tools.ietf.org/html/rfc6265

Sample code:
http://www.tcpdump.org/pcap.html
http://www.tcpdump.org/sniffex.c
http://inst.eecs.berkeley.edu/~ee122/fa07/projects/p2files/packet_parser.c
https://www.winpcap.org/docs/docs_412/html/group__wpcap__tut6.html
http://unix.superglobalmegacorp.com/Net2/newsrc/netinet/
http://stackoverflow.com/questions/4265016/conversion-of-ethernet-address-to-readable-form
http://www.binarytides.com/raw-sockets-c-code-linux/
https://ubuntuforums.org/showthread.php?t=1586890
http://stackoverflow.com/questions/14410128/how-to-verify-tcp-checksum
http://yuba.stanford.edu/~casado/pcap/section1.html
http://stackoverflow.com/questions/30404099/right-way-to-compute-cosine-similarity-between-two-arrays
http://codereview.stackexchange.com/questions/142331/cosine-similarity

General guides, miscellaneous:
https://www.google.com/search?q=c+command+line+flags
http://stackoverflow.com/questions/11668172/how-do-i-calculate-ip-header-length
https://linux.die.net/man/3/pcap_dispatch
http://www.tcpipguide.com/free/t_TCPChecksumCalculationandtheTCPPseudoHeader-2.htm
http://securitynik.blogspot.com/2015/08/calculating-udp-checksum-with-taste-of_3.html
http://unix.stackexchange.com/questions/118247/echo-bytes-to-a-file
http://stackoverflow.com/questions/18961420/reverse-the-endianness-of-a-c-structure
http://stackoverflow.com/questions/1491660/pcap-struct-pcap-pkthdr-len-vs-caplen
http://www.tcpdump.org/pcap.html
https://delog.wordpress.com/2010/12/13/information-in-a-pcap-file-with-a-single-udp-packet/
https://forums.linuxmint.com/viewtopic.php?t=237102
http://stackoverflow.com/questions/2481269/how-to-make-a-simple-c-makefile
http://stackoverflow.com/questions/787533/is-pragma-once-a-safe-include-guard
http://stackoverflow.com/questions/3202136/using-g-to-compile-multiple-cpp-and-h-files
http://stackoverflow.com/questions/422830/structure-of-a-c-object-in-memory-vs-a-struct
http://askubuntu.com/questions/74059/how-do-i-run-wireshark-with-root-privileges/74064#74064
http://www.roman10.net/2011/11/27/how-to-calculate-iptcpudp-checksumpart-1-theory/
http://www.rhyshaden.com/tcp.htm
http://www.saminiir.com/lets-code-tcp-ip-stack-3-tcp-handshake/
http://stackoverflow.com/questions/17746688/convert-unsigned-char-to-string
https://www.tutorialspoint.com/cplusplus/cpp_constructor_destructor.htm
http://stackoverflow.com/questions/17595797/how-to-use-memcpy-in-struct-in-c
http://stackoverflow.com/questions/9579930/separating-class-code-into-a-header-and-cpp-file
http://makepp.sourceforge.net/1.19/makepp_tutorial.html
https://www.codingunit.com/c-tutorial-the-functions-malloc-and-free
http://stackoverflow.com/questions/1433204/how-do-i-use-extern-to-share-variables-between-source-files-in-c
https://www.cyberciti.biz/faq/bash-for-loop/
https://www.shellhacks.com/bash-test-if-file-exists/
http://stackoverflow.com/questions/3866202/vector-resize-automatic-fill
http://stackoverflow.com/questions/9263658/how-to-get-a-pointer-from-a-reference
http://www.cplusplus.com/reference/queue/queue/pop/
http://stackoverflow.com/questions/5222404/c-value-of-uninitialized-vectorint
https://text-compare.com
http://stackoverflow.com/questions/1919626/can-i-get-a-non-const-c-string-back-from-a-c-string
http://stackoverflow.com/questions/3513173/converting-ostream-into-standard-string
https://www.tutorialspoint.com/cplusplus/assignment_operators_overloading.htm
https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol
https://en.wikipedia.org/wiki/Store_and_forward
https://en.wikipedia.org/wiki/Push_technology
https://en.wikipedia.org/wiki/MIME
https://en.wikipedia.org/wiki/Email_client
https://en.wikipedia.org/wiki/Message_submission_agent
https://en.wikipedia.org/wiki/Message_transfer_agent
https://en.wikipedia.org/wiki/MX_record
https://en.wikipedia.org/wiki/Bounce_address
https://en.wikipedia.org/wiki/Smart_host
https://en.wikipedia.org/wiki/Mail_delivery_agent
https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol
https://en.wikipedia.org/wiki/Post_Office_Protocol
http://www.tcpipguide.com/free/t_SMTPConnectionandSessionEstablishmentandTerminatio.htm
http://www.tcpipguide.com/free/t_TCPIPClientEphemeralPortsandClientServerApplicatio.htm
http://freesoft.org/CIE/Topics/94.htm
http://stackoverflow.com/questions/14746889/casting-from-unsigned-into-signed-char-in-c
https://www.tutorialspoint.com/cplusplus/returning_values_by_reference.htm
http://stackoverflow.com/questions/4931123/copying-one-structure-to-another
http://stackoverflow.com/questions/5059049/read-an-string-line-by-line-using-c
http://stackoverflow.com/questions/7397768/choice-between-vectorresize-and-vectorreserve
http://zone.ni.com/reference/en-XX/help/371361H-01/lvhowto/backslash_codes_display/

</external references>
