Install:
make install

Compile, build:
clear; make clean; make all

Run:
bin/packetparse ./smtp.pcap                             # ETH-IP
bin/packetparse ./sampleimf.pcap                        # ETH-IP
bin/packetparse -t ./smtp.pcap      && bash least.sh    # ETH-IP-TCP
bin/packetparse -t ./sampleimf.pcap && bash least.sh    # ETH-IP-TCP
bin/packetparse -m ./smtp.pcap      && bash smtp.sh     # ETH-IP-TCP-SMTP
bin/packetparse -m ./sampleimf.pcap && bash smtp.sh     # ETH-IP-TCP-SMTP
bin/packetparse -c ./cookie.pcap    && bash cookies.sh  # ETH-IP-TCP-HTTP

Verbose error-logging (very slow), e.g.:
COMMAND = "bin/packetparse ./smtp.pcap"
clear; make clean; make all && valgrind --track-origins=yes --leak-check=full --show-leak-kinds=all $COMMAND

Check intermediate debug output (after running TCP-IP-TCP-SMTP):
bash debug.sh
